# Windowsåˆ°Linuxè¿ç§»æ£€æŸ¥æ¸…å•

## ğŸ“‹ è¿ç§»å‰æ£€æŸ¥

### 1. å½“å‰Windowsç³»ç»Ÿé…ç½®æ£€æŸ¥
- [ ] è®°å½•å½“å‰Pythonç‰ˆæœ¬ï¼š`python --version`
- [ ] è®°å½•å½“å‰ä¾èµ–åŒ…ç‰ˆæœ¬ï¼š`pip freeze > windows_requirements.txt`
- [ ] ç¡®è®¤å½“å‰ç›‘å¬ç«¯å£å’ŒIPé…ç½®
- [ ] æ£€æŸ¥Windowsç‰¹å®šé…ç½®æ–‡ä»¶

### 2. æ•°æ®å¤‡ä»½
- [ ] å¤‡ä»½æ•°æ®åº“æ–‡ä»¶ï¼š
  - [ ] `database.db`
  - [ ] `order_checker.db`
  - [ ] `order_checker.db-shm`
  - [ ] `order_checker.db-wal`
- [ ] å¤‡ä»½é™æ€æ–‡ä»¶ç›®å½•ï¼š
  - [ ] `static/uploads/`
  - [ ] `static/replays/`
- [ ] å¤‡ä»½é…ç½®æ–‡ä»¶ï¼š
  - [ ] `config.py`
  - [ ] `requirements.txt`
- [ ] å¤‡ä»½æ—¥å¿—æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ï¼š
  - [ ] `logs/` ç›®å½•
- [ ] å¤‡ä»½ä¸´æ—¶æ–‡ä»¶ï¼ˆå¦‚éœ€è¦ï¼‰ï¼š
  - [ ] `temp/` ç›®å½•

### 3. ç¯å¢ƒå˜é‡è®°å½•
è®°å½•å½“å‰Windowsç³»ç»Ÿä¸­çš„ç¯å¢ƒå˜é‡ï¼š
- [ ] `SECRET_KEY`: `+Dm2%%%%3;|;9%%%%v`
- [ ] `HOST`: `0.0.0.0`
- [ ] `PORT`: `80`
- [ ] `PUBLIC_URL`: `http://103.164.81.222`
- [ ] å…¶ä»–Waitressç›¸å…³é…ç½®

## ğŸš€ Linuxç³»ç»Ÿéƒ¨ç½²

### 1. ç³»ç»Ÿå‡†å¤‡
- [ ] ç¡®è®¤Linuxå‘è¡Œç‰ˆå’Œç‰ˆæœ¬
- [ ] æ›´æ–°ç³»ç»ŸåŒ…ï¼š
  ```bash
  # Ubuntu/Debian
  sudo apt-get update && sudo apt-get upgrade
  
  # CentOS/RHEL
  sudo yum update
  
  # Fedora
  sudo dnf update
  ```

### 2. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
- [ ] å°†é¡¹ç›®æ–‡ä»¶ä¸Šä¼ åˆ°LinuxæœåŠ¡å™¨
- [ ] å»ºè®®è·¯å¾„ï¼š`/opt/financial-card-service/` æˆ– `/var/www/financial-card-service/`

### 3. è®¾ç½®æ‰§è¡Œæƒé™
```bash
chmod +x install_linux.sh start.sh run_linux.sh
```

### 4. è¿è¡Œå®‰è£…è„šæœ¬
- [ ] æ‰§è¡Œï¼š`./install_linux.sh`
- [ ] é€‰æ‹©æ˜¯å¦åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èé€‰æ‹© yï¼‰
- [ ] ç¡®è®¤æ‰€æœ‰ä¾èµ–å®‰è£…æˆåŠŸ

### 5. æ¢å¤æ•°æ®
- [ ] å°†å¤‡ä»½çš„æ•°æ®åº“æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®æ ¹ç›®å½•
- [ ] å°†å¤‡ä»½çš„é™æ€æ–‡ä»¶å¤åˆ¶åˆ° `static/` ç›®å½•
- [ ] è®¾ç½®é€‚å½“çš„æ–‡ä»¶æƒé™ï¼š
  ```bash
  sudo chown -R www-data:www-data /path/to/project
  sudo chmod -R 755 /path/to/project
  sudo chmod 644 *.db
  ```

### 6. æµ‹è¯•è¿è¡Œ
- [ ] å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼š`./run_linux.sh`
- [ ] æ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸è®¿é—®ï¼š`http://æœåŠ¡å™¨IP:5000`
- [ ] æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½
- [ ] æµ‹è¯•ä¸»è¦åŠŸèƒ½

## ğŸ”§ ç”Ÿäº§ç¯å¢ƒé…ç½®

### 1. åˆ›å»ºç³»ç»ŸæœåŠ¡
- [ ] åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶ï¼š`/etc/systemd/system/financial-card-service.service`
- [ ] é…ç½®æœåŠ¡å‚æ•°ï¼ˆç”¨æˆ·ã€å·¥ä½œç›®å½•ã€ç¯å¢ƒå˜é‡ç­‰ï¼‰
- [ ] å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š
  ```bash
  sudo systemctl daemon-reload
  sudo systemctl enable financial-card-service
  sudo systemctl start financial-card-service
  ```
- [ ] æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š`sudo systemctl status financial-card-service`

### 2. é…ç½®åå‘ä»£ç†ï¼ˆæ¨èï¼‰
- [ ] å®‰è£…Nginxï¼š
  ```bash
  # Ubuntu/Debian
  sudo apt-get install nginx
  
  # CentOS/RHEL
  sudo yum install nginx
  ```
- [ ] åˆ›å»ºNginxé…ç½®æ–‡ä»¶
- [ ] æµ‹è¯•é…ç½®ï¼š`sudo nginx -t`
- [ ] é‡å¯Nginxï¼š`sudo systemctl restart nginx`

### 3. é˜²ç«å¢™é…ç½®
- [ ] å¼€æ”¾HTTPç«¯å£ï¼ˆ80ï¼‰ï¼š
  ```bash
  # UFW (Ubuntu)
  sudo ufw allow 80/tcp
  
  # Firewalld (CentOS/RHEL/Fedora)
  sudo firewall-cmd --permanent --add-service=http
  sudo firewall-cmd --reload
  ```
- [ ] å¼€æ”¾HTTPSç«¯å£ï¼ˆ443ï¼Œå¦‚ä½¿ç”¨SSLï¼‰
- [ ] å¦‚æœä¸ä½¿ç”¨åå‘ä»£ç†ï¼Œå¼€æ”¾åº”ç”¨ç«¯å£

### 4. SSLè¯ä¹¦é…ç½®ï¼ˆæ¨èï¼‰
- [ ] å®‰è£…Certbotï¼š
  ```bash
  # Ubuntu/Debian
  sudo apt-get install certbot python3-certbot-nginx
  
  # CentOS/RHEL
  sudo yum install certbot python3-certbot-nginx
  ```
- [ ] è·å–SSLè¯ä¹¦ï¼š`sudo certbot --nginx -d your-domain.com`
- [ ] è®¾ç½®è‡ªåŠ¨ç»­æœŸï¼š`sudo crontab -e`

## ğŸ” åŠŸèƒ½éªŒè¯

### 1. åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] é¦–é¡µè®¿é—®æ­£å¸¸
- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½
- [ ] æ•°æ®æŸ¥è¯¢åŠŸèƒ½
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½

### 2. æ€§èƒ½æµ‹è¯•
- [ ] å¹¶å‘è®¿é—®æµ‹è¯•
- [ ] å†…å­˜ä½¿ç”¨ç›‘æ§
- [ ] CPUä½¿ç”¨ç›‘æ§
- [ ] ç£ç›˜IOç›‘æ§

### 3. æ—¥å¿—æ£€æŸ¥
- [ ] åº”ç”¨æ—¥å¿—ï¼š`tail -f logs/app.log`
- [ ] ç³»ç»ŸæœåŠ¡æ—¥å¿—ï¼š`sudo journalctl -u financial-card-service -f`
- [ ] Nginxæ—¥å¿—ï¼ˆå¦‚ä½¿ç”¨ï¼‰ï¼š`tail -f /var/log/nginx/access.log`

## ğŸ›¡ï¸ å®‰å…¨é…ç½®

### 1. åŸºç¡€å®‰å…¨
- [ ] æ›´æ”¹é»˜è®¤å¯†é’¥ï¼šä¿®æ”¹ `SECRET_KEY` ç¯å¢ƒå˜é‡
- [ ] ç¦ç”¨ä¸å¿…è¦çš„æœåŠ¡
- [ ] å®šæœŸæ›´æ–°ç³»ç»ŸåŒ…

### 2. åº”ç”¨å®‰å…¨
- [ ] é…ç½®é€‚å½“çš„æ–‡ä»¶æƒé™
- [ ] ä½¿ç”¨érootç”¨æˆ·è¿è¡Œåº”ç”¨
- [ ] é™åˆ¶æ•°æ®åº“æ–‡ä»¶è®¿é—®æƒé™

### 3. ç½‘ç»œå®‰å…¨
- [ ] é…ç½®é˜²ç«å¢™è§„åˆ™
- [ ] ä½¿ç”¨HTTPSåŠ å¯†
- [ ] é…ç½®fail2bané˜²æ­¢æš´åŠ›ç ´è§£

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. è®¾ç½®ç›‘æ§
- [ ] é…ç½®æ—¥å¿—è½®è½¬ï¼š
  ```bash
  sudo nano /etc/logrotate.d/financial-card-service
  ```
- [ ] å®‰è£…ç›‘æ§å·¥å…·ï¼š`htop`, `iotop`, `netstat`
- [ ] è®¾ç½®ç£ç›˜ç©ºé—´ç›‘æ§

### 2. å¤‡ä»½ç­–ç•¥
- [ ] åˆ›å»ºè‡ªåŠ¨å¤‡ä»½è„šæœ¬
- [ ] è®¾ç½®cronå®šæ—¶ä»»åŠ¡
- [ ] æµ‹è¯•å¤‡ä»½æ¢å¤æµç¨‹

### 3. æ›´æ–°ç­–ç•¥
- [ ] åˆ¶å®šæ›´æ–°æµç¨‹
- [ ] æµ‹è¯•æ›´æ–°æ­¥éª¤
- [ ] å‡†å¤‡å›æ»šæ–¹æ¡ˆ

## âŒ åˆ é™¤Windowsç›¸å…³æ–‡ä»¶

è¿ç§»å®Œæˆå¹¶ç¡®è®¤Linuxç³»ç»Ÿè¿è¡Œæ­£å¸¸åï¼š
- [ ] åœ¨LinuxæœåŠ¡å™¨ä¸Šåˆ é™¤Windowsæ‰¹å¤„ç†æ–‡ä»¶ï¼š
  - [ ] `start.bat`
  - [ ] `run.bat`
- [ ] æ›´æ–°æ–‡æ¡£ï¼Œç§»é™¤Windowsç›¸å…³è¯´æ˜

## ğŸ“ è¿ç§»å®Œæˆç¡®è®¤

### æœ€ç»ˆæ£€æŸ¥
- [ ] åº”ç”¨æ­£å¸¸è¿è¡Œ
- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚
- [ ] å®‰å…¨é…ç½®å®Œæˆ
- [ ] ç›‘æ§å’Œå¤‡ä»½å°±ä½
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ

### è®°å½•ä¿¡æ¯
- **è¿ç§»å®Œæˆæ—¶é—´**: ________________
- **LinuxæœåŠ¡å™¨IP**: ________________
- **åŸŸåï¼ˆå¦‚æœ‰ï¼‰**: ________________
- **è´Ÿè´£äºº**: ________________
- **å¤‡æ³¨**: 
  ```
  
  
  
  ```

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æƒé™é—®é¢˜**
   ```bash
   sudo chown -R www-data:www-data /path/to/project
   sudo chmod -R 755 /path/to/project
   ```

2. **ç«¯å£å ç”¨**
   ```bash
   sudo netstat -tlnp | grep :80
   sudo lsof -i :80
   ```

3. **Pythonç‰ˆæœ¬é—®é¢˜**
   ```bash
   python3 --version
   which python3
   ```

4. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   pip cache purge
   pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
   ```

### è”ç³»æ”¯æŒ
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼š`logs/app.log`
- æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š`sudo journalctl -u financial-card-service`
- è®°å½•é”™è¯¯ä¿¡æ¯å¹¶å¯»æ±‚æŠ€æœ¯æ”¯æŒ 